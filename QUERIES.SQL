-- 1.SALARY REPORTS
-- TOP 5 HIGHEST PAID EMPLOYEES
SELECT E.EMP_NAME,(S.BASE_SALARY+S.BONUS) AS TOTAL_SALARY
FROM EMPLOYEES E JOIN SALARY S
ON E.EMP_ID = S.EMP_ID
ORDER BY BASE_SALARY DESC
LIMIT 5;

-- AVERAGE SALARY BY DEPT
SELECT D.DEPT_NAME,AVG(S.BASE_SALARY+S.BONUS) AS AVG_SALARY
FROM EMPLOYEES E JOIN SALARY S
ON E.EMP_ID = S.EMP_ID JOIN DEPARTMENTS D
ON E.DEPT_ID = D.DEPT_ID
GROUP BY DEPT_NAME;

-- EMPLOYEES WITH BASE_SALARY > 25000
SELECT E.EMP_NAME,S.BASE_SALARY
FROM EMPLOYEES E JOIN SALARY S
ON E.EMP_ID = S.EMP_ID
WHERE S.BASE_SALARY > 25000;

-- MAXIMUM AND MINIMUM SALARY OF THE EMPLOYEES
SELECT MAX(BASE_SALARY) AS MAX_SAL,MIN(BASE_SALARY) AS MIN_SAL
FROM SALARY;

-- 2.EMPLOYEE HIERARCHY
-- LIST EMPLOYEES AND THIER MANAGER NAMES
SELECT E.EMP_NAME AS EMP_NAME,M.EMP_NAME AS MGR_NAME
FROM EMPLOYEES E JOIN EMPLOYEES M
ON E.MGR_ID = M.EMP_ID;

-- EMPLOYEES WITHOUT MANAGERS
SELECT EMP_NAME
FROM EMPLOYEES
WHERE MGR_ID IS NULL;

-- COUNT OF EMP'S PER MANAGER
SELECT M.EMP_NAME AS MANAGER,COUNT(*) AS TEAM_SIZE
FROM EMPLOYEES E JOIN EMPLOYEES M
ON E.MGR_ID = M.EMP_ID
GROUP BY M.EMP_NAME;

-- HIERARCHICAL DISPLAY OF EMPLOYEES AND MANAGER
SELECT E.EMP_ID,E.EMP_NAME AS EMP_NAME,M.EMP_NAME AS MGR_NAME
FROM EMPLOYEES E JOIN EMPLOYEES M
ON E.MGR_ID = M.EMP_ID;

-- 3.SEARCH EMPLOYEES
-- EMPLOYEES IN DEPARTMENT 'IT'
SELECT E.EMP_NAME,D.DEPT_NAME
FROM EMPLOYEES E JOIN DEPARTMENTS D
ON E.DEPT_ID  = D.DEPT_ID
WHERE D.DEPT_NAME = 'IT';

-- EMPLOYEES WITH ROLE CONTAINING 'DATA ANALYST'
SELECT E.EMP_NAME,R.ROLES
FROM EMPLOYEES E JOIN ROLES R
ON E.ROLE_ID = R.ROLE_ID
WHERE ROLES = 'DATA ANALYST';

-- EMPLOYEES HIRED AFTER 2021 AND BEFORE 2024
SELECT EMP_NAME,HIREDATE
FROM EMPLOYEES
WHERE HIREDATE BETWEEN '2022-01-01' AND '2023-12-31';

-- EMPLOYEES BY NAME ALPHABETICALLY
SELECT EMP_NAME
FROM EMPLOYEES
ORDER BY EMP_NAME ASC;

-- 4.ANALYTICAL QUERIES
-- DEPARTMENT WITH HIGHEST AVERAGE SALARY
SELECT D.DEPT_NAME,AVG(S.BASE_SALARY+S.BONUS) AS HIGHEST_AVG_SAL
FROM EMPLOYEES E JOIN DEPARTMENTS D
ON E.DEPT_ID = D.DEPT_ID JOIN SALARY S
ON E.EMP_ID = S.EMP_ID
GROUP BY D.DEPT_NAME 
ORDER BY AVG(S.BASE_SALARY+S.BONUS) DESC
LIMIT 1;

-- COUNT OF EMPLOYEES IN EACH DEPARTMENT
SELECT D.DEPT_NAME, COUNT(*) AS "NO. OF EMP'S"
FROM EMPLOYEES E JOIN DEPARTMENTS D
ON E.DEPT_ID = D.DEPT_ID
GROUP BY D.DEPT_NAME ;

-- TOTAL SALARY COST PER DEPARTMENT
SELECT D.DEPT_NAME,SUM(S.BASE_SALARY+S.BONUS) AS TOTAL_SALARY
FROM DEPARTMENTS D JOIN EMPLOYEES E
ON D.DEPT_ID = E.DEPT_ID JOIN SALARY S
ON E.EMP_ID = S.EMP_ID
GROUP BY D.DEPT_NAME ;

-- EMPLOYEES WITH SAME ROLE
SELECT ROLE_ID,COUNT(EMP_ID) AS ROLE_COUNT
FROM EMPLOYEES
GROUP BY ROLE_ID;
